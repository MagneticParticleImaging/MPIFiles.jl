<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Low Level Interface · MPI Files</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="MPI Files logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">MPI Files</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li><a class="tocitem" href="gettingStarted.html">Getting Started</a></li><li class="is-active"><a class="tocitem" href="lowlevel.html">Low Level Interface</a><ul class="internal"><li><a class="tocitem" href="#In-memory-MDF"><span>In-memory MDF</span></a></li></ul></li><li><a class="tocitem" href="conversion.html">Conversion</a></li><li><a class="tocitem" href="measurements.html">Measurements</a></li><li><a class="tocitem" href="systemmatrix.html">System Matrices</a></li><li><a class="tocitem" href="frequencyFilter.html">Frequency Filter</a></li><li><a class="tocitem" href="reconstruction.html">Reconstruction Results</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="lowlevel.html">Low Level Interface</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="lowlevel.html">Low Level Interface</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/MagneticParticleImaging/MPIFiles.jl/blob/master/docs/src/lowlevel.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Low-Level-Interface"><a class="docs-heading-anchor" href="#Low-Level-Interface">Low Level Interface</a><a id="Low-Level-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Low-Level-Interface" title="Permalink"></a></h1><p>The low level interface of MPIFiles.jl consists of a collection of methods that need to be implemented for each file format. It consists of the following methods</p><pre><code class="language-julia hljs"># general
version, uuid

# study parameters
studyName, studyNumber, studyUuid, studyDescription

# experiment parameters
experimentName, experimentNumber, experimentUuid, experimentDescription,
experimentSubject, experimentIsSimulation, experimentIsCalibration,
experimentHasMeasurement, experimentHasReconstruction

# tracer parameters
tracerName, tracerBatch, tracerVolume, tracerConcentration, tracerSolute,
tracerInjectionTime, tracerVendor

# scanner parameters
scannerFacility, scannerOperator, scannerManufacturer, scannerName, scannerTopology

# acquisition parameters
acqStartTime, acqNumFrames, acqNumAverages, acqGradient, acqOffsetField,
acqNumPeriodsPerFrame, acqSize

# drive-field parameters
dfNumChannels, dfStrength, dfPhase, dfBaseFrequency, dfCustomWaveform, dfDivider,
dfWaveform, dfCycle

# receiver parameters
rxNumChannels, rxBandwidth, rxNumSamplingPoints, rxTransferFunction, rxUnit,
rxDataConversionFactor, rxInductionFactor

# measurements
measData, measDataTDPeriods, measIsFourierTransformed, measIsTFCorrected,
measIsBGCorrected, measIsFastFrameAxis, measIsFramePermutation, measIsFrequencySelection,
measIsBGFrame, measIsSpectralLeakageCorrected, measFramePermutation

# calibrations
calibSNR, calibFov, calibFovCenter, calibSize, calibOrder, calibPositions,
calibOffsetField, calibDeltaSampleSize, calibMethod, calibIsMeanderingGrid

# reconstruction results
recoData, recoFov, recoFovCenter, recoSize, recoOrder, recoPositions

# additional functions that should be implemented by an MPIFile
filepath, systemMatrixWithBG, systemMatrix, selectedChannels</code></pre><p>The interface is structured in a similar way as the parameters within the <a href="https://github.com/MagneticParticleImaging/MDF">MDF</a>. Basically, there is a direct mapping between the MDF parameters and the MPIFiles interface. For instance the parameter <code>acqNumAvarages</code> maps to the MDF parameter <code>/acquisition/numAverages</code>. Also the dimensionality of the parameters described in the <a href="https://github.com/MagneticParticleImaging/MDF">MDF</a> is preserved. Thus, the MDF specification can be used as a documentation of the low level interface of MPIFiles.</p><h2 id="In-memory-MDF"><a class="docs-heading-anchor" href="#In-memory-MDF">In-memory MDF</a><a id="In-memory-MDF-1"></a><a class="docs-heading-anchor-permalink" href="#In-memory-MDF" title="Permalink"></a></h2><p>Since during data acquisition it is not advisable to write the data directly to an MDF file, there is also an in-memory representation. It can be created either empty by <code>mdf = MDFv2InMemory()</code> or with default values set by <code>mdf = defaultMDFv2InMemory()</code>. The same interface as described above applies to the in-memory version. When writing it to disk using <code>saveasMDF(&quot;your/file/path/file.mdf&quot;, mdf)</code> it is checked for consistency. If this check should fail with an error, use <code>saveasMDF(&quot;your/file/path/file.mdf&quot;, mdf, failOnInconsistent=true)</code>. The default is to not fail in order to not lose measurement data in case of an error.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Note that the dimensions in the MDF documentation are flipped compared to the dimensions in Julia. This is because Julia stores the data in column major order, while HDF5 considers row major order</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="gettingStarted.html">« Getting Started</a><a class="docs-footer-nextpage" href="conversion.html">Conversion »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Wednesday 8 June 2022 13:57">Wednesday 8 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
